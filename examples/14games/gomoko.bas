10 REM "GOMOKO from 101 BASIC games"
20 REM "Ported to Stefan's BASIC 2021"
30 REM
40 DIM A(19*20)
100 PRINT "WELCOME TO THE ORIENTAL GAME OF GOMOKO."
110 PRINT: PRINT "THE GAME IS PLAYED ON AN N BY N GRID OF A SIZE"
120 PRINT "THAT YOU SPECIFY.  DURING YOUR PLAY, YOU MAY COVER ONE GRID"
130 PRINT "INTERSECTION WITH A MARKER. THE OBJECT OF THE GAME IS TO GET"
140 PRINT "5 ADJACENT MARKERS IN A ROW -- HORIZONTALLY, VERTICALLY, OR"
150 PRINT "DIAGONALLY.  ON THE BOARD DIAGRAM, YOUR MOVES ARE MARKED"
160 PRINT "WITH A '1' AND THE COMPUTER MOVES WITH A '2'."
165 PRINT: PRINT "THE COMPUTER DOES NOT KEEP TRACK OF WHO HAS WON."
170 PRINT "TO END THE GAME, TYPE -1,-1 FOR YOUR MOVE.": PRINT
180 INPUT "WHAT IS YOUR BOARD SIZE (MIN 7/ MAX 19)?", N
185 IF N>6 AND N<20 THEN 200
190 PRINT "THE MINIMUM IS 7, THE MAXIMUM IS 19.": GOTO 180 
200 REM "Main loop()"
210 FOR I=1 TO N
220 FOR J=1 TO N
230 A(I+J*N)=0
240 NEXT J
250 NEXT I 
300 PRINT: PRINT "WE ALTERNATE MOVES.  YOU GO FIRST...": PRINT
310 PRINT "YOUR PLAY ": INPUT " I: ";I: INPUT " J: ";J
315 PRINT
320 IF I=-1 THEN 980
330 X=I: Y=J: GOSUB 910: IF L=1 THEN 410
340 PRINT "ILLEGAL MOVE.  TRY AGAIN...": GOTO 310
410 IF A(I+J*N)=0 THEN 440
420 PRINT "SQUARE OCCUPIED.  TRY AGAIN...": GOTO 310
440 A(I+J*N)=1
500 REM *** COMPUTER TRIES AN INTELLIGENT MOVE ***
510 FOR E=-1 TO 1
520 FOR F=-1 TO 1
530 IF E+F-E*F=0 THEN 585
540 X=I+F: Y=J+F: GOSUB 910
570 IF L=0 THEN 585
580 IF A(X+Y*N)=1 THEN 710
585 REM
590 NEXT F
595 NEXT E
600 REM *** COMPUTER TRIES A RANDOM MOVE ***
610 X=RND(N)+1: Y=RND(N)+1: GOSUB 910: IF L=0 THEN 610
650 IF A(X+Y*N)<>0 THEN 610
660 A(X+Y*N)=2: GOSUB 800: GOTO 310
710 X=I-E: Y=J-F: GOSUB 910
750 IF L=0 THEN 610
760 GOTO 650
800 REM *** PRINT THE BOARD ***
805 PRINT "I  "
810 FOR I=1 TO N
815 PRINT #3,I;
820 FOR J=1 TO N
830 PRINT A(I+J*N);
840 NEXT J
850 PRINT
860 NEXT I
865 PRINT: 
863 PRINT "J  "; 
865 FOR J=1 TO N
866 IF J<10 PRINT " ";: ELSE PRINT "1";
867 NEXT
868 PRINT: PRINT "   ";
870 FOR J=1 TO N: PRINT J%10;: NEXT J: PRINT 
880 PRINT
890 RETURN
910 L=1: IF X<1 THEN 970
920 IF X>N THEN 970
930 IF Y<1 THEN 970
940 IF Y>N THEN 970
950 RETURN
970 L=0: RETURN
980 PRINT: PRINT "THANKS FOR THE GAME!!"
985 PRINT "PLAY AGAIN (1 FOR YES, 0 FOR NO)";: INPUT Q
990 IF Q=1 THEN 110
999 END
